generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Account {
  id          String        @id @default(cuid())
  email       String        @unique
  name        String
  type        ClientType
  createdAt   DateTime      @default(now())
  deposits    Deposits[]
  withdrawals Withdrawals[]
}

enum ClientType {
  RETAIL
  INSTITUTIONAL
}

model Deposits {
  id                String        @id @default(cuid())
  account           Account       @relation(fields: [accountId], references: [id])
  accountId         String // Made due to annoted types
  depositNumber     String        @unique
  metalType         String // Gold, Silver and Platinum , etc.. 
  storageType       StorageType
  quantity          Float // In Kg
  remainingQuantity Float // In Kg
  barSerial         String?       @unique // When allocated storage-- Helps identify specific allocated metals
  depositedAt       DateTime      @default(now())
  withdrawals       Withdrawals[]
}

enum StorageType {
  ALLOCATED
  UNALLOCATED
}

model Withdrawals {
  id               String      @id @default(cuid())
  account          Account     @relation(fields: [accountID], references: [id])
  accountID        String
  withdrawalNumber String      @unique
  deposit          Deposits?   @relation(fields: [depositId], references: [id])
  depositId        String? // In case they withdraw a metal from an allocated storage
  barSerial        String?     @unique // When allocated storage-- Helps identify specific allocated metals
  storageType      StorageType
  quantity         Float // In Kg
  withdrawnAt      DateTime    @default(now())
  metalType        String // Gold, Silver and Platinum , etc..
}
